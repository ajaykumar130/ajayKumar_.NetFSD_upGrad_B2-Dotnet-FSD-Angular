<!DOCTYPE html>
<html>
<head>
    <title>Location Logger</title>
</head>
<body>
    <h2>Location Based Logger</h2>
    <button onclick="getLocation()">Get My Location</button>
    <h3>Current Location:</h3>
    <p id="currentLocation"></p>
    <h3>Last 5 Locations:</h3>
    <ul id="historyList"></ul>
    <p id="errorMsg" style="color:red;"></p>
    <script>
        window.onload = function () {
            displayHistory();
        };
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(successCallback,errorCallback,{ timeout: 10000 });
            } else {
                document.getElementById("errorMsg").innerText ="Geolocation not supported.";
            }
        }
        function successCallback(position) {
            let latitude = position.coords.latitude;
            let longitude = position.coords.longitude;
            document.getElementById("currentLocation").innerText ="Latitude: " + latitude +" | Longitude: " + longitude;
            document.getElementById("errorMsg").innerText = "";
            let locationData = {lat: latitude,lon: longitude,time: new Date().toLocaleString()};
            let history = localStorage.getItem("locationHistory");
            history = history ? JSON.parse(history) : [];
            history.unshift(locationData);
            if (history.length > 5) {
                history.pop();
            }
            localStorage.setItem("locationHistory",JSON.stringify(history)
            );
            displayHistory();
        }
        function errorCallback(error) {
            let message = "";
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    message = "Permission denied.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    message = "Location unavailable.";
                    break;
                case error.TIMEOUT:
                    message = "Request timed out.";
                    break;
                default:
                    message = "Unknown error.";
            }
            document.getElementById("errorMsg").innerText = message;
        }

        function displayHistory() {

            let history = localStorage.getItem("locationHistory");
            history = history ? JSON.parse(history) : [];
            let list = document.getElementById("historyList");
            list.innerHTML = "";
            history.forEach(function (item) {
                let li = document.createElement("li");
                li.innerText ="Lat: " + item.lat +", Lon: " + item.lon +" (" + item.time + ")";
                list.appendChild(li);
            });
        }
    </script>
</body>
</html>